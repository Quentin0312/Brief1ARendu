<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Ajout code multiplication ludique -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="holistic.css">

    <title>Le site a NoNo</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-cyborg-gaming.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
<!--

TemplateMo 579 Cyborg Gaming

https://templatemo.com/tm-579-cyborg-gaming

-->
  </head>

<body>


  <!-- ***** Header Area Start ***** -->
  <header class="header-area header-sticky">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="main-nav">
                    <!-- ***** Logo Start ***** -->
                    <a href="index.html" class="logo">
                        <img src="assets/images/logo.png" alt="">
                    </a>
                    <!-- ***** Logo End ***** -->
                    <!-- ***** Search End ***** -->
                    <div class="search-input">
                      <form id="search" action="#">
                        <input type="text" placeholder="Type Something" id='searchText' name="searchKeyword" onkeypress="handle" />
                        <i class="fa fa-search"></i>
                      </form>
                    </div>
                    <!-- ***** Search End ***** -->
                    <!-- ***** Menu Start ***** -->
                    <ul class="nav">
                        <li><a href="index.html" class="active">Home</a></li>
                        <li><a href="browse.html">Browse</a></li>
                        <li><a href="details.html">Details</a></li>
                        <li><a href="streams.html">Streams</a></li>
                        <li><a href="profile.html">Profile <img src="assets/images/profile-header.jpg" alt=""></a></li>
                    </ul>   
                    <a class='menu-trigger'>
                        <span>Menu</span>
                    </a>
                    <!-- ***** Menu End ***** -->
                </nav>
            </div>
        </div>
    </div>
  </header>
  <!-- ***** Header Area End ***** -->

  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="page-content">

          <!-- ***** Banner Start ***** -->
          <!-- Ajout code multiplication ludique -->
          <div class="container">
            <video hidden class="input_video"></video>
            <canvas class="output_canvas" width="1280px" height="720px"></canvas>
            <h1 hidden id="resultatAffiche1"> live main droite</h1>
            <h1 hidden id="resultatAffiche2"> live main gauche</h1>
            <h1 hidden id="resultatAfficheTotal"> live total</h1>
            <h1 hidden id="resultatM1Time"> M1 time</h1>
            <h1 hidden id="resultatM2Time"> M2 time</h1>
            <h1 hidden id="resultatTotalTime"> Total time</h1>
            <h1 hidden id="multiplication"> Multiplication</h1>
			
			 <script type="module">
        const videoElement = document.getElementsByClassName('input_video')[0];
        const canvasElement = document.getElementsByClassName('output_canvas')[0];
        const canvasCtx = canvasElement.getContext('2d');

        console.log("debut decl des variable");

        var img = new Image();
        img.src = "images/beach.jpg";


        let numImage = 0;

        // var imgMontagne = new Image();
        // img.src = "images/montagne.jpg";

        //1=> entre dans cette fonctionalité
        let menu = 1;
        let jeuMultiplication = 0;
        let jeuBallons = 0;

        //Menu
        let dessusBouton1 = [];
        let iterationsMenu = 20;

        let dessusBouton3 = [];

        //Il faut tou déclarer car cette zone ne boucle pas
        //F1 - Jeu Multiplication

        //Déclaration variable code hand

        let dessusBouton2 = [];

        var imgNuage = new Image();
        imgNuage.src = "images/nuage_1_transp.png";

        let mainG = [];
        let sommeMG = 0;
        let mainD = [];
        let sommeMD = 0;

        
        let conditionNuage1 = 0; // 1=> nuage affiché
        let conditionNuage2 = 0; // "
        let conditionNuage3 = 0;
        let conditionNuage4 = 0;

        let resultatM1 = [];
        let resultatM2 = [];
        let resultatTotal = [];

        let zero = [];
        let un = [];
        let deux = [];
        let trois = [];
        let quatre = [];
        let cinq = [];

        let iterations = 20; //itérations entré valeurs chiffre mais aussi symbole indexs contact

        let mainM1;
        let mainM2;
        let totalTime;

        let symboleIndexs = [];
        let symboleIndexs2 = []; //permet de reinit les nuages
        let indexs = 0;
        let phalangeIndexs = 0;

        let operande1 = 0;
        let operande2 = 0;
        let produit;

        let derOperande1;
        let derOperande2;
        let derProduit;

        console.log("fin decl variable");

        function onResults(results) {
            //Menu
            if(menu == 1){
                if(results.segmentationMask){
                    //Affichage du canva ----------------------------------------------------------------------------------------------------------
                    canvasCtx.save();
                    canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
                    canvasCtx.drawImage(results.segmentationMask, 0, 0,canvasElement.width, canvasElement.height);

                    canvasCtx.globalCompositeOperation = 'source-in';
                    canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);

                    canvasCtx.globalCompositeOperation = 'destination-atop';
                    canvasCtx.drawImage(img, 0, 0, canvasElement.width, canvasElement.height);

                    //Au premier plan
                    canvasCtx.globalCompositeOperation = 'source-over';
                    drawConnectors(canvasCtx, results.leftHandLandmarks, HAND_CONNECTIONS,{color: '#CC0000', lineWidth: 5}); // batons main gauche
                    drawLandmarks(canvasCtx, results.leftHandLandmarks,{color: '#00FF00', lineWidth: 2});// points main gauche
                    drawConnectors(canvasCtx, results.rightHandLandmarks, HAND_CONNECTIONS,{color: '#00CC00', lineWidth: 5}); //batons main droite
                    drawLandmarks(canvasCtx, results.rightHandLandmarks,{color: '#FF0000', lineWidth: 2}); //points main droite

                    //Inversion des elements
                    canvasCtx.translate(1280, 0);
                    // flip context horizontally
                    canvasCtx.scale(-1, 1);

                    //bouton F1
                    canvasCtx.fillStyle = 'yellow';
                    canvasCtx.fillRect(130, 55, 500, 60);
                    canvasCtx.font = "50px Georgia";
                    canvasCtx.fillStyle = 'blue';
                    canvasCtx.fillText("Multiplication ludique",130,100);

                    //bouton background
                    canvasCtx.fillStyle = 'white';
                    canvasCtx.fillRect(1000, 400, 266, 60);
                    canvasCtx.font = "50px Georgia";
                    canvasCtx.fillStyle = 'green';
                    canvasCtx.fillText("Background",1000,450);
                    canvasCtx.restore();

                    //position main droite
                    let posMainD = [];
                    let posEnX = 0;
                    let posEnY = 0;

                    //Algo menu => sélection avec main droite
                    //detection moyenne points de la main droite
                    if(results.rightHandLandmarks){

                        //moy des x (0 à droite 1 à gauche attention image mirrored)
                        for(let i = 0; i<21;i++){
                            posEnX += results.rightHandLandmarks[i].x;
                        }
                        posMainD[0] = posEnX / 21;
                        // console.log("X =>",results.rightHandLandmarks[8].x);
                        //moy des y (0 en haut 1 en bas )
                        for(let i = 0;i<21;i++){
                            posEnY += results.rightHandLandmarks[i].y;
                        }
                        posMainD[1] = posEnY /21;
                        // console.log(posMainD);
                        // console.log("Y=>",results.rightHandLandmarks[8].y);
                    }
                    
                    //detecte si main droite au dessus boutons "multiplication ludique"
                    if(results.rightHandLandmarks && posMainD[0] >= 0.49 && posMainD[0] <= 0.9 && posMainD[1] <= 0.16 && posMainD[1] >= 0.04){
                        // console.log("tu y es mon pote");
                        dessusBouton1.push("1");
                    }
                    else{
                        dessusBouton1.push("0");
                    }
                    // console.log(dessusBouton1);
                    //action en conséquence selon iterationsMenu
                    if(dessusBouton1.length >= iterationsMenu){
                        let derDessusBouton1 = dessusBouton1.slice(-iterationsMenu);
                        let derDessusBouton1Verdict = 0;
                        for(let i = 0;i<iterationsMenu;i++){
                            derDessusBouton1Verdict += Number(derDessusBouton1[i]);
                        }
                        if(derDessusBouton1Verdict > 0.90 * iterationsMenu){
                            //action
                            // console.log("'click'");
                            jeuMultiplication = 1;
                        }
                    }

                    //detecte si main droite au dessus bouton "background"
                    if(results.rightHandLandmarks && posMainD[0] >= 0.01 && posMainD[0] <= 0.22 && posMainD[1] <= 0.65 && posMainD[1] >= 0.55){
                        // console.log("tu y es mon pote");
                        dessusBouton3.push("1");
                    }
                    else{
                        dessusBouton3.push("0");
                    }

                    //action en conséquences
                    if(dessusBouton3.length >= iterationsMenu){
                        let derDessusBouton3 = dessusBouton3.slice(-iterationsMenu);
                        let derDessusBouton3Verdict = 0;
                        for(let i = 0;i<iterationsMenu;i++){
                            derDessusBouton3Verdict += Number(derDessusBouton3[i]);
                        }
                        if(derDessusBouton3Verdict > 0.90 * iterationsMenu){
                            //action
                            console.log("'click'");
                            // numImage += 1;
                            // console.log(img.src);
                            // img.src = "images/montagne.jpg";
                            console.log(img.src);
                            if(img.src == "http://127.0.0.1:5500/images/beach.jpg"){
                                img.src = "images/montagne.jpg";  
                                dessusBouton3 = [];                    
                            }
                            else if(img.src = "http://127.0.0.1:5500/images/montagne.jpg"){
                                img.src = "images/beach.jpg";
                                dessusBouton3 = [];
                            }

                        }
                    }

                    //A la fin effacer toute les variable utilisé soit avec undefined soit =0
                }
            }
            //entre dans F1
            if(jeuMultiplication == 1){
                if(results.segmentationMask){
            canvasCtx.save();
            canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
            canvasCtx.drawImage(results.segmentationMask, 0, 0,
                                canvasElement.width, canvasElement.height);
          
            // Only overwrite existing pixels.
            canvasCtx.globalCompositeOperation = 'source-in';
          //   canvasCtx.fillStyle = '#00FF00';
          //   canvasCtx.fillRect(0, 0, canvasElement.width, canvasElement.height);

          canvasCtx.drawImage(
                results.image, 0, 0, canvasElement.width, canvasElement.height);

            // Only overwrite missing pixels.
            canvasCtx.globalCompositeOperation = 'destination-atop';

          //   canvasCtx.filter = "blur(10px)";
            // flux video
            canvasCtx.drawImage(
                img, 0, 0, canvasElement.width, canvasElement.height);

            canvasCtx.globalCompositeOperation = 'source-over';
            console.log(mainM1);

            //Affiche le nuage 1
            if(totalTime >0 && totalTime <=10 || conditionNuage1 == 1){ // ajouter || condition 1 = 1 ou  operande1 != 0
                canvasCtx.drawImage(imgNuage,1000,0,230,144); //Nuage mainM1 mettre en variable pour pouvoir modifier une seul place nuage + contenu
                conditionNuage1 = 1;
            }
            //Affiche le nuage 2
            if(operande1 > 0 && operande1 <= 10 || conditionNuage3 == 1){
                canvasCtx.drawImage(imgNuage,750,0,230,144); //Nuage "x"
                conditionNuage2 = 1;
            }
            //Affiche le nuage 3
            if(conditionNuage1 == 1 && conditionNuage2 == 1){
                canvasCtx.drawImage(imgNuage,500,0,230,144); //Nuage mainM2
                conditionNuage3 =1;
            }
            //Affiche le nuage 4
            if(conditionNuage1 == 1 && conditionNuage2 ==1 && produit == derOperande1 * derOperande2){
                canvasCtx.drawImage(imgNuage,145,0,230,144); //Nuage produit
                conditionNuage4 =1;
            }
            //Combiner les structures logiques logiques ci-dessus

          //   drawConnectors(canvasCtx, results.poseLandmarks, POSE_CONNECTIONS,
          //                  {color: '#00FF00', lineWidth: 4}); //body batons
          //   drawLandmarks(canvasCtx, results.poseLandmarks,
          //                 {color: '#FF0000', lineWidth: 2}); //body points
          //   drawConnectors(canvasCtx, results.faceLandmarks, FACEMESH_TESSELATION,
          //                  {color: '#C0C0C070', lineWidth: 1}); //visage mesh
            drawConnectors(canvasCtx, results.leftHandLandmarks, HAND_CONNECTIONS,
                          {color: '#CC0000', lineWidth: 5}); // batons main gauche
            drawLandmarks(canvasCtx, results.leftHandLandmarks,
                          {color: '#00FF00', lineWidth: 2});// points main gauche
            drawConnectors(canvasCtx, results.rightHandLandmarks, HAND_CONNECTIONS,
                          {color: '#00CC00', lineWidth: 5}); //batons main droite
            drawLandmarks(canvasCtx, results.rightHandLandmarks,
                          {color: '#FF0000', lineWidth: 2}); //points main droite
            
            //Inversion des elements
            // translate context to center of canvas
            canvasCtx.translate(1280, 0);
            // flip context horizontally
            canvasCtx.scale(-1, 1);
            
            //bouton menu
            canvasCtx.fillStyle = 'white';
            canvasCtx.fillRect(1000, 550, 133, 60);
            canvasCtx.font = "50px Georgia";
            canvasCtx.fillStyle = 'orange';
            canvasCtx.fillText("Menu",1000,600);

            canvasCtx.fillStyle = 'blue';
            canvasCtx.font = "100px Georgia";

            //Dans nuage 1 afficher le live main
            if (operande1 == 0 && totalTime >0 && totalTime <=10 && conditionNuage2 == 0 ){ //else if ?
                canvasCtx.fillText(totalTime,130,100);
            }
            //Dans nuage 1 afficher operande 1
            else if(totalTime >0 && totalTime <=10 && conditionNuage4 != 1 || conditionNuage4 != 1 && conditionNuage2 == 1){ // ajouter || condition 1 = 1
                canvasCtx.fillText(operande1,130,100); //operande 1
            }
            //Dans nuage 1 afficher derOperande1
            else if(derOperande1 != undefined){
                canvasCtx.fillText(derOperande1,130,100); //derOperande 1
            }
            //Dans le nuage operateur affiche "X"
            if(operande1 > 0 && operande1 <= 10 || conditionNuage2 == 1){
                canvasCtx.fillText('X',360,100); // operateur
            }
            //Dans nuage 3 afficher live main
            if(conditionNuage1 == 1 && conditionNuage2 == 1 && totalTime >0 && totalTime <=10 && conditionNuage4 != 1){
                canvasCtx.fillText(totalTime,600,100); //operande 2
            }
            else if(derOperande2 != undefined){
                canvasCtx.fillText(derOperande2,600,100); //derOperande 2
            }
            //Dans nuage 4 afficher resultat
            if(conditionNuage1 == 1 && conditionNuage2 == 1 && produit == derOperande1 * derOperande2){
                canvasCtx.fillText('='+produit,925,100); // produit
            }

            //Réinitialisation des nuages-----------------------------------------------------------------------
            if(conditionNuage1 == 1 && conditionNuage2 == 1 && conditionNuage3 == 1 && conditionNuage4 == 1){
            //Detection symbole indexs
            if (results.rightHandLandmarks && results.leftHandLandmarks){

                if (indexs < phalangeIndexs){
                    symboleIndexs2.push("1"); //1 Correspond à contact
                    // console.log("Contact!!!!!!!!!!");
                }
                else if(indexs > phalangeIndexs){
                    symboleIndexs2.push("0"); //0 Correspond à pas de contact
                    // console.log("Pas contact");
                }

                if (symboleIndexs2.length >= iterations){

                    let dersymboleIndexs2 = symboleIndexs2.slice(-iterations);
                    let dersymboleIndexs2Verdict = 0;
                    for (let i = 0; i < iterations; i++){
                        dersymboleIndexs2Verdict += Number(dersymboleIndexs2[i]);
                    }
                    if (dersymboleIndexs2Verdict > 0.90*iterations){
                        //action
                        conditionNuage1 = 0;
                        conditionNuage2 = 0;
                        conditionNuage3 = 0;
                        conditionNuage4 = 0;
                        operande1 = 0;
                        operande2 = 0;
                        produit = undefined;

                        derOperande1= undefined;
                        derOperande2= undefined;
                        derProduit= undefined;

                        symboleIndexs2 = [];
                    }

                }
            }

            }
            canvasCtx.restore();

            //position main droite
            let posMainD = [];
            let posEnX = 0;
            let posEnY = 0;


          //Intégration du code hand a faire ici-------------------------------------------

            let chiffre1;
            let chiffre2;
            let chiffreTotal;

            //Algo menu => sélection avec main droite
            //detection moyenne points de la main droite
            if(results.rightHandLandmarks){

                //moy des x (0 à droite 1 à gauche attention image mirrored)
                for(let i = 0; i<21;i++){
                    posEnX += results.rightHandLandmarks[i].x;
                }
                posMainD[0] = posEnX / 21;
                // console.log("X =>",results.rightHandLandmarks[8].x);
                //moy des y (0 en haut 1 en bas )
                for(let i = 0;i<21;i++){
                    posEnY += results.rightHandLandmarks[i].y;
                }
                posMainD[1] = posEnY /21;
                // console.log(posMainD);
                // console.log("Y=>",results.rightHandLandmarks[8].y);
            }

            //detecte si main droite au dessus boutons "menu"
            if(results.rightHandLandmarks && posMainD[0] >= 0.11 && posMainD[0] <= 0.23 && posMainD[1] <= 0.86 && posMainD[1] >= 0.75){
                // console.log("tu y es mon pote");
                dessusBouton2.push("1");
            }
            else{
                dessusBouton2.push("0");
            }
            // console.log(dessusBouton1);
            if(dessusBouton2.length >= iterations){
                let derDessusBouton2 = dessusBouton2.slice(-iterations);
                let derDessusBouton2Verdict = 0;
                for(let i = 0;i<iterations;i++){
                    derDessusBouton2Verdict += Number(derDessusBouton2[i]);
                }
                if(derDessusBouton2Verdict > 0.90 * iterations){
                    //action
                    console.log("'click'");
                    menu = 1;
                    jeuMultiplication =0;
                }
            }



          //Détermine le symbole contact indexs
          if (results.rightHandLandmarks && results.leftHandLandmarks){

            let hand1 = results.rightHandLandmarks;
            let hand2 = results.leftHandLandmarks;

            indexs = (hand1[8].x) - (hand2[8].x);
            indexs = Math.abs(indexs);

            phalangeIndexs = (hand1[8].x)-(hand1[7].x);
            phalangeIndexs = Math.abs(phalangeIndexs);
            // if (indexs < phalangeIndexs){
            //   console.log("contact!!!");
            // }
            // else{
            //   console.log("Pas contact");
            // }
          }

          //Main Droite
          if (results.rightHandLandmarks && indexs > phalangeIndexs || results.rightHandLandmarks && !results.leftHandLandmarks){
              let main1 = results.rightHandLandmarks;
              chiffre1 = 0;

              //Pos main et entrée dans chiffre 1, valeur live
              if(main1[2].y > main1[9].y){ //Quand mains "à l'endroit"
                  // console.log("actuel");

                  if (main1[8].y < main1[7].y && main1[6].y < main1[5].y){
                  chiffre1 += 1;
                  // console.log("index");
                  }

                  if (main1[12].y < main1[11].y && main1[10].y < main1[9].y){
                      chiffre1 += 1;
                  //   console.log("majeur");
                  }

                  if (main1[16].y < main1[15].y && main1[14].y < main1[13].y){
                      chiffre1 += 1;
                  //   console.log("annulaire");
                  }

                  if (main1[20].y < main1[19].y && main1[18].y < main1[17].y){
                      chiffre1 += 1;
                  //   console.log("auriculaire");
                  }
                  //Pouce à gauche de la mains
                  if((main1[4].x > main1[3].x) &&(main1[20].x < main1[4].x) && (main1[8].x - main1[0].x)-(main1[4].x - main1[0].x)<0){
                  //   console.log("pouce1");
                      chiffre1 += 1;
                  }
                  //Pouce à gauche de la mains
                  if((main1[4].x < main1[3].x) &&(main1[20].x > main1[4].x) && (main1[8].x - main1[0].x)-(main1[4].x - main1[0].x)>0){
                  //   console.log("pouce2");
                      chiffre1 += 1;
                  }

              }
              else if(true){ // Quand mains "allongé"
              // console.log("et ouis")

              if(main1[4].y < main1[3].y){
                  // console.log("pouce bleu");
                  chiffre1 += 1;
              }
              //Doigt à gauche de la mains
              if( (main1[7].x > main1[0].x) && (main1[8].x > main1[7].x)){
                  // console.log("index bleu");
                  chiffre1 += 1;
              }
              //Doigt à droite de la mains
              if( (main1[7].x < main1[0].x) && (main1[8].x < main1[7].x)){
                  // console.log("index bleu");
                  chiffre1 += 1;
              }
              //Doigt à gauche de la mains
              if( (main1[11].x > main1[0].x) && (main1[12].x > main1[11].x)){
                  // console.log("majeur bleu");
                  chiffre1 += 1;
              }
              //Doigt à droite de la mains
              if( (main1[11].x < main1[0].x) && (main1[12].x < main1[11].x)){
                  // console.log("majeur bleu");
                  chiffre1 += 1;
              }
              //Doigt à gauche de la mains
              if( (main1[15].x > main1[0].x) && (main1[16].x > main1[15].x)){
                  // console.log("annulaire bleu");
                  chiffre1 += 1;
              }
              //Doigt à droite de la mains
              if( (main1[15].x < main1[0].x) && (main1[16].x < main1[15].x)){
                  // console.log("annulaire bleu");
                  chiffre1 += 1;
              }
              //Doigt à gauche de la mains
              if( (main1[19].x > main1[0].x) && (main1[20].x > main1[19].x)){
                  // console.log("auriculaire bleu");
                  chiffre1 += 1;
              }
              //Doigt à droite de la mains
              if( (main1[19].x < main1[0].x) && (main1[20].x < main1[19].x)){
                  // console.log("auriculaire bleu");
                  chiffre1 += 1;
              }

              }

              //Affichage du resultat main 1
              //Timing du resultat main 1
              resultatM1.push(chiffre1);
              document.getElementById("resultatAffiche1").innerHTML = "Live main 1 : "+chiffre1;
              if (!results.leftHandLandmarks){
                  resultatM2.push(0);
              }

              if (resultatM1.length >= iterations){
                  let m120der = resultatM1.slice(-iterations);
                  // console.log("-------------",m120der);
                  for (let i = 0;i < iterations; i++){

                      if (m120der[i]==0){
                          zero.push(0);
                      }
                      else{
                          zero.push(0);
                      }
                      if (m120der[i]==1){
                          un.push(1);
                      }
                      else{
                          un.push(0);
                      }
                      if (m120der[i]==2){
                          deux.push(2);
                      }
                      else{
                          deux.push(0);
                      }
                      if (m120der[i]==3){
                          trois.push(3);
                      }
                      else{
                          trois.push(0);
                      }
                      if (m120der[i]==4){
                          quatre.push(4);
                      }
                      else{
                          quatre.push(0);
                      }
                      if (m120der[i]==5){
                          cinq.push(5);
                      }
                      else{
                          cinq.push(0);
                      }

                  }
                  zero = zero.slice(-iterations);
                  un = un.slice(-iterations);
                  deux = deux.slice(-iterations);
                  trois = trois.slice(-iterations);
                  quatre = quatre.slice(-iterations);
                  cinq = cinq.slice(-iterations);
                  // console.log("5=>",cinq);

                  let sommeCinq = 0;
                  let sommeUn = 0;
                  let sommeDeux = 0;
                  let sommeTrois = 0;
                  let sommeQuatre = 0;

                  for (let i = 0;i < iterations; i++){
                      sommeCinq += cinq[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeUn += un[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeDeux += deux[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeTrois += trois[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeQuatre += quatre[i];
                  }

                  let pourcentage= 0.75;

                  if (sommeUn > 1*iterations*pourcentage){
                      mainM1 = 1;
                  }
                  else if (sommeDeux > 2*iterations*pourcentage){
                      mainM1 = 2;
                  }
                  else if (sommeTrois > 3*iterations*pourcentage){
                      mainM1 = 3;
                  }
                  else if (sommeQuatre > 4*iterations*pourcentage){
                      mainM1 = 4;
                  }
                  else if (sommeCinq > 5*iterations*pourcentage){
                      mainM1 = 5;
                  }
                //   else{
                //       mainM1 = "erreurM1";
                //   }

              }
          }
          
          //Main 2
          if (results.leftHandLandmarks && indexs > phalangeIndexs || results.leftHandLandmarks && !results.rightHandLandmarks){ // ajouter || results.leftHandLandmarks && !results.rightHandLandmarks
              let main2 = results.leftHandLandmarks;
              chiffre2 = 0;

              //Pos main
              if(main2[2].y > main2[9].y){ //Quand mains "à l'endroit"
                  // console.log("actuel");

                  if (main2[8].y < main2[7].y && main2[6].y < main2[5].y){
                  chiffre2 += 1;
                  // console.log("index");
                  }

                  if (main2[12].y < main2[11].y && main2[10].y < main2[9].y){
                      chiffre2 += 1;
                  //   console.log("majeur");
                  }

                  if (main2[16].y < main2[15].y && main2[14].y < main2[13].y){
                      chiffre2 += 1;
                  //   console.log("annulaire");
                  }

                  if (main2[20].y < main2[19].y && main2[18].y < main2[17].y){
                      chiffre2 += 1;
                  //   console.log("auriculaire");
                  }
                  //Pouce à gauche de la mains
                  if((main2[4].x > main2[3].x) &&(main2[20].x < main2[4].x) && (main2[8].x - main2[0].x)-(main2[4].x - main2[0].x)<0){
                  //   console.log("pouce1");
                      chiffre2 += 1;
                  }
                  //Pouce à gauche de la mains
                  if((main2[4].x < main2[3].x) &&(main2[20].x > main2[4].x) && (main2[8].x - main2[0].x)-(main2[4].x - main2[0].x)>0){
                  //   console.log("pouce2");
                      chiffre2 += 1;
                  }

              }
              else if(true){ // Quand mains "allongé"
              // console.log("et ouis")

                  if(main2[4].y < main2[3].y){
                      // console.log("pouce bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à gauche de la mains
                  if( (main2[7].x > main2[0].x) && (main2[8].x > main2[7].x)){
                      // console.log("index bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à droite de la mains
                  if( (main2[7].x < main2[0].x) && (main2[8].x < main2[7].x)){
                      // console.log("index bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à gauche de la mains
                  if( (main2[11].x > main2[0].x) && (main2[12].x > main2[11].x)){
                      // console.log("majeur bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à droite de la mains
                  if( (main2[11].x < main2[0].x) && (main2[12].x < main2[11].x)){
                      // console.log("majeur bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à gauche de la mains
                  if( (main2[15].x > main2[0].x) && (main2[16].x > main2[15].x)){
                      // console.log("annulaire bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à droite de la mains
                  if( (main2[15].x < main2[0].x) && (main2[16].x < main2[15].x)){
                      // console.log("annulaire bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à gauche de la mains
                  if( (main2[19].x > main2[0].x) && (main2[20].x > main2[19].x)){
                      // console.log("auriculaire bleu");
                      chiffre2 += 1;
                  }
                  //Doigt à droite de la mains
                  if( (main2[19].x < main2[0].x) && (main2[20].x < main2[19].x)){
                      // console.log("auriculaire bleu");
                      chiffre2 += 1;
                  }

              }

              //Affichage resultat main 2
              // console.log("chiffre 2:", chiffre2);
              let resultatAffiche2 = document.getElementById("resultatAffiche2").innerHTML = "Live main 2 : " +chiffre2;

              //Timing du resultat main 2
              resultatM2.push(chiffre2);
              // console.log("M2",resultatM2);
              if (resultatM2.length >= iterations){
                  let m120der = resultatM2.slice(-iterations);
                  // console.log("-------------",m120der);
                  for (let i = 0;i < iterations; i++){

                      if (m120der[i]==0){
                          zero.push(0);
                      }
                      else{
                          zero.push(0);
                      }
                      if (m120der[i]==1){
                          un.push(1);
                      }
                      else{
                          un.push(0);
                      }
                      if (m120der[i]==2){
                          deux.push(2);
                      }
                      else{
                          deux.push(0);
                      }
                      if (m120der[i]==3){
                          trois.push(3);
                      }
                      else{
                          trois.push(0);
                      }
                      if (m120der[i]==4){
                          quatre.push(4);
                      }
                      else{
                          quatre.push(0);
                      }
                      if (m120der[i]==5){
                          cinq.push(5);
                      }
                      else{
                          cinq.push(0);
                      }

                  }
                  zero = zero.slice(-iterations);
                  un = un.slice(-iterations);
                  deux = deux.slice(-iterations);
                  trois = trois.slice(-iterations);
                  quatre = quatre.slice(-iterations);
                  cinq = cinq.slice(-iterations);
                  // console.log("5=>",cinq);

                  let sommeCinq = 0;
                  let sommeUn = 0;
                  let sommeDeux = 0;
                  let sommeTrois = 0;
                  let sommeQuatre = 0;

                  for (let i = 0;i < iterations; i++){
                      sommeCinq += cinq[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeUn += un[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeDeux += deux[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeTrois += trois[i];
                  }
                  for (let i = 0;i < iterations; i++){
                      sommeQuatre += quatre[i];
                  }

                  let pourcentage= 0.75;

                  if (sommeUn > 1*iterations*pourcentage){
                      mainM2 = 1;
                  }
                  else if (sommeDeux > 2*iterations*pourcentage){
                      mainM2 = 2;
                  }
                  else if (sommeTrois > 3*iterations*pourcentage){
                      mainM2 = 3;
                  }
                  else if (sommeQuatre > 4*iterations*pourcentage){
                      mainM2 = 4;
                  }
                  else if (sommeCinq > 5*iterations*pourcentage){
                      mainM2 = 5;
                  }
                  else{
                      mainM2 = "erreur";
                  }

              }



          }
          
          //Affichage resultat total live
          if(results.rightHandLandmarks && results.leftHandLandmarks){
          chiffreTotal = chiffre1 + chiffre2;
          }
          else if(results.rightHandLandmarks){
            chiffreTotal = chiffre1;
          }
          else if(results.leftHandLandmarks){
            chiffreTotal = chiffre2;
          }
          let resultatAfficheTotal = document.getElementById("resultatAfficheTotal").innerHTML = "Live total : " +chiffreTotal;

          
          // Détection main gauche devant la cam
          if(results.leftHandLandmarks){
            mainG.push(1);
          }
          else{
            mainG.push(0);
          }
          if(mainG.length >= iterations){
            mainG = mainG.slice(-iterations);
            sommeMG = 0;
            for (let i =0 ; i<iterations ; i++){
                sommeMG += mainG[i];
            }
           }
          // Détection main droite devant la cam
          if(results.rightHandLandmarks){
            mainD.push(1);
          }
          else{
            mainD.push(0);
          }
          if(mainD.length >= iterations){
            mainD = mainD.slice(-iterations);
            sommeMD = 0;
            for (let i =0 ; i<iterations ; i++){
                sommeMD += mainD[i];
            }
          }

          //Affichage total time
          if(mainM2 > 0 && mainM2 <=10 && mainM1 > 0 && mainM1 <=10 && results.rightHandLandmarks && results.leftHandLandmarks){
            totalTime = mainM1 + mainM2;

          }
          else if(results.rightHandLandmarks && mainM1 > 0 && mainM1 <=10 && sommeMG <= 0.25*iterations){ //Pourcentage inversé car les 1 sont mainG présente ici on veut qu'elle soit absente à 75%
            totalTime = mainM1;
          }
          else if(results.leftHandLandmarks && mainM2 > 0 && mainM2 <=10 && sommeMD <= 0.25*iterations){ //"
            totalTime = mainM2;
          }
        
          
          //Fonctionnalite Multiplication - Detecion du contact index et time
          if (results.rightHandLandmarks && results.leftHandLandmarks){

            if (indexs < phalangeIndexs){
                symboleIndexs.push("1"); //1 Correspond à contact
                // console.log("Contact!!!!!!!!!!");
            }
            else if(indexs > phalangeIndexs){
                symboleIndexs.push("0"); //0 Correspond à pas de contact
                // console.log("Pas contact");
            }

            if (symboleIndexs.length >= iterations){

                let derSymboleIndexs = symboleIndexs.slice(-iterations);
                let derSymboleIndexsVerdict = 0;
                for (let i = 0; i < iterations; i++){
                    derSymboleIndexsVerdict += Number(derSymboleIndexs[i]);
                }
                if (derSymboleIndexsVerdict > 0.90*iterations){
                    //action



                    // => ici enregistrer la valeur precedente de main 1 ou total et entre dans variable lien autre fonctionnalité, universelle => permet d'entrer une valeur
                    if (operande1 == 0){
                        operande1 = totalTime;
                        derOperande1 = totalTime;
                        symboleIndexs = [];
                    }
                    else{
                        operande2 = totalTime;
                        derOperande2 = totalTime;
                        symboleIndexs = [];
                    }
                    console.log("Operande1 : "+operande1);
                    console.log("Operande2 : "+operande2);
                }
            }

          }

          //Fonctionnalite Multiplication - Coeur
          if (operande1>0 && operande2>0){
              produit = operande1 * operande2;
              derProduit = derOperande1 * derOperande2;
            //   console.log(produit);
              operande1 = 0;
              operande2 = 0;
          }

          //Affichage à l'écran
          document.getElementById("resultatTotalTime").innerHTML = "Total => " +totalTime;
          if (mainM1>0 && mainM1 <= 5){
              document.getElementById("resultatM1Time").innerHTML = "Main 1 : "+mainM1 ;
          }
          if (mainM2>0 && mainM2 <= 5){
              document.getElementById("resultatM2Time").innerHTML = "Main 2 : "+mainM2;
          }
          document.getElementById("multiplication").innerHTML = derOperande1 + " X " + derOperande2 + " = " + derProduit; 
            }
            }
        
        //dessous
        }

        
        const holistic = new Holistic({locateFile: (file) => {
          return `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`;
        }});
        holistic.setOptions({
          modelComplexity: 2,
          smoothLandmarks: true,
          enableSegmentation: true,
          smoothSegmentation: true,
          refineFaceLandmarks: true,
          minDetectionConfidence: 0.5,
          minTrackingConfidence: 0.5
        });
        holistic.onResults(onResults);
        
        const camera = new Camera(videoElement, {
          onFrame: async () => {
            await holistic.send({image: videoElement});
          },
          width: 1280,
          height: 720
        });
        camera.start();
    </script>
          <!-- Fin ajout code multiplication ludique -->

        </div>

        </div>
      </div>
    </div>
  </div>
  


  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/popup.js"></script>
  <script src="assets/js/custom.js"></script>


  </body>

</html>
